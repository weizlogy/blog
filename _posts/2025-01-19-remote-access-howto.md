---
layout: post
title:  "Android端末でメインPCを外出先から操作するための備忘録"
date:   2025-01-19 18:00:00 09:00
description: "Android端末からWindows PCをリモート操作！Wake on LAN (WoL)、マジックパケット送信、リモートソフト（Chromeリモートデスクトップ, Parsec, Moonlight）の選定と比較など、設定方法やハマりポイントを開発者視点で解説します。"
categories: system-dev
---

「あー、外出先から家のPCのあのファイルが欲しい！」とか、「ちょっと家のPCで自作ソフトの動作確認したいんだけどな～」って思うこと、あるよね？
この記事は、私が実際にAndroid端末からメインPC（Windowsだよ！）をリモート操作できるようにした時のアレコレをまとめた備忘録なんだ。

<!--more-->

![eyecatch](/assets/img/20250120eyecatch.webp)

## 概要

この記事を読めば、あなたもこんなことができるようになるかもしれません。

- **スリープ中のPCを遠隔起動**: Wake on LAN (WoL) の設定方法を解説します。
- **マジックパケットでPCを起動**: マジックパケットを送信する具体的な仕組み作りを紹介します。
- **あなたに合うソフトは？**: リモート接続用ソフトをいくつか試し、メリット・デメリットをレビューします。

快適なリモートPCライフを目指しましょう。

## Wake on LANの設定

メインPCのマザーボードはASROCK B550M-HDVくん。以下の設定をUEFIから設定します。

<small>（ASRock B550M-HDVの場合の例です。マザーボードのメーカーやモデルによってメニュー名や設定場所は異なることがあるため、ご自身の環境のマニュアルもご確認ください。）</small>
```text
Advanced > ACPI Configuration > PCIE Devices Power On > Enabled 
```
ネットワークアダプターのプロパティから、「Magic Packetでのみ、コンピューターのスタンバイ状態を解除できるようにする」に
チェックを入れます。
<small>（この設定は、意図しないネットワークアクセスでPCが勝手に起動するのを防ぐために重要です。）</small>

## マジックパケット送信の仕掛け

LAN内にDS215jというSynology製のNASがあるので、そこから送れるようにします。

- Synology NASにはMagic Packet送出コマンドがある

```text
/usr/syno/sbin/synonet --wake （該当PCのMACアドレス : 区切り） eth0;
```

- タスクスケジューラーを使って任意のコマンドを実行する

タスクスケジューラーの設定について詳しく説明している[サイト](http://rikuntyudady.fc2.net/blog-entry-1375.html)があります。
このような情報を公開してくださる方には感謝です。
<small>（リンク切れの場合は、「Synology NAS タスクスケジューラ コマンド実行」などで検索すると、新しい情報が見つかるかもしれません。）</small>

念の為、常時起動しているファブレット<small>（Windows搭載タブレットのことです）</small>のSurfacePro2くんからも送れるようにします。

この[スクリプト](https://poga.jp/?p=182)が超便利だったので使わせていただきます。助かります。
<small>（PowerShellでマジックパケットを送信するスクリプトです。便利なツールを公開してくださる方には本当に感謝です。）</small>

## リモート接続用ソフト選定

### Chromeリモートデスクトップ
メリット
- 導入簡単
- スマホの小さい画面でも拡縮できて見やすい
- Googleアカウントだけで手軽に始められます。

デメリット
- 画質荒い、ラグい
- ホストが再起動すると繋げられない
- 簡単なファイル確認やテキスト編集程度なら問題ありませんが、本格的な作業には向いていないかもしれません。

### Parsec
メリット
- 導入簡単、画質良い、ラグ少なめ
- ホストが再起動しても繋げられる
- ゲーミングにも耐えうる低遅延が特徴です。
- (有償サブスクリプションでホスト画面オフなどの追加機能あり)

デメリット
- Androidアプリはかなり使いにくい
キーボード表示すると、画面がキーボードに被らないように小さくなる→見にくい
- 画面の拡大縮小ができない→見にくい
- マウスカーソルは表示されない→操作しにくい
- PC間の接続は快適ですが、Androidアプリの操作性は改善の余地がありそうです。(無償版の場合)

### Moonlight + Sunshine + Tailscale
メリット
- 画質良い
- 仮想ゲームパッド付いてくるの強い
- NVIDIAのGameStream技術がベースなので、ゲーム用途には最適かもしれません。
- Tailscaleを使えば、ポート開放なしでVPN環境を構築できます。

デメリット
- 導入面倒、ラグい
- 外から繋げるのにVPN必須
- MoonlightのUIが古めかしい
- 画面の拡大縮小ができない
- ホストが再起動すると繋げられない
- 設定項目が多く、やや上級者向けですが、環境が整えば非常に強力な選択肢です。

### Razer PC Remote Play (Razer Cortex Mobile)

メリット
- 導入は比較的簡単。
- リモートアクセス中、ホストPCの画面が消えるのはセキュリティ的にも良い。(試した範囲ではParsecの有償版以外ではこれだけ)

デメリット
- 物理コントローラーが前提の操作感。タッチ操作での細かい作業は難しいかも。
- Razerアカウントが必要。

### Steam Link

メリット。
- 最低ビットレートが3Mbpsと低いので、回線速度がそれほど速くない環境でも試しやすい。
- 仮想ゲームパッドがカスタマイズしやすく、使いやすい。

デメリット
- たまに「リレーサーバーに接続できません」といったエラーで繋がらないことがある。(その場合、一度他の手段でPCに接続しSteamを再起動すると直ることが多い)

## まとめ

色々と試しましたが、Androidから快適に操作できる決定的なソフトは見つからないのが現状です。
**Parsec**の低遅延は魅力的ですが、Androidアプリの操作性が改善されない限り、常用は難しいでしょう。
**Chromeリモートデスクトップ**は手軽ですが、画質と遅延が課題です。
**Moonlight + Sunshine + Tailscale**の組み合わせは高機能ですが、設定の複雑さと遅延が気になります。
**Razer PC Remote Play**はホスト画面オフという利点がありますが、コントローラー操作がメインとなりそうです。
**Steam Link**は優秀ですが、たまに接続が不安定になることがあるようです。

最終的には、「何を最も重視するか」で選択するソフトが変わってくるでしょう。
例えば、手軽さならChrome、ゲームならParsec(無償版)やMoonlight、セキュリティや追加機能を求めるならParsec(有償版)やRazer、そしてSteamユーザーならSteam Linkも有力な選択肢になるでしょう。
私自身、より快適なソリューションを探す旅はまだ続きそうです。
この記事が、あなたのリモートアクセス環境構築のヒントになれば幸いです。

もし、「こんなソフトもあるよ！」とか「この設定試してみて！」みたいな情報があったら、ぜひ教えてもらえると嬉しいです！
